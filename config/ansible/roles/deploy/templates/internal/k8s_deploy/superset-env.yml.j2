---

apiVersion: v1
kind: ConfigMap
metadata:
  name: configmap-{{ stage }}-{{ project_name }}-superset-env
  namespace: {{ k8s_namespace }}
data:
  # database configurations (do not modify)
  DATABASE_DB={{ superset_db_name }}
  DATABASE_HOST={{ my_host }}
  # Make sure you set this to a unique secure random value on production
  DATABASE_PASSWORD={{ superset_db_pass }}
  DATABASE_USER={{ superset_db_user }}

  EXAMPLES_DB=examples
  EXAMPLES_HOST=db
  EXAMPLES_USER=examples
  # Make sure you set this to a unique secure random value on production
  EXAMPLES_PASSWORD=examples
  EXAMPLES_PORT=5432

  # database engine specific environment variables
  # change the below if you prefer another database engine
  DATABASE_PORT={{ superset_db_port }}
  DATABASE_DIALECT={{ database_dialect }}
  # Make sure you set this to a unique secure random value on production
  MYSQL_DATABASE={{ superset_db_name }}
  MYSQL_USER={{ superset_db_user }}
  MYSQL_PASSWORD={{ superset_db_pass }}
  MYSQL_RANDOM_ROOT_PASSWORD=yes

  # Add the mapped in /app/pythonpath_docker which allows devs to override stuff
  PYTHONPATH=/app/pythonpath:/app/docker/pythonpath_dev
  REDIS_HOST={{ superset_redis_host }}
  REDIS_PORT={{ superset_redis_port }}

  FLASK_DEBUG=true
  SUPERSET_ENV=production
  SUPERSET_LOAD_EXAMPLES=no
  CYPRESS_CONFIG=false
  SUPERSET_PORT=8088
  MAPBOX_API_KEY=''

  # Make sure you set this to a unique secure random value on production
  SUPERSET_SECRET_KEY={{ superset_secret_key }}

  # To prevent XSS attacks (among other things)
  TALISMAN_ENABLED=yes

  ENABLE_PLAYWRIGHT=false
  PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true
  BUILD_SUPERSET_FRONTEND_IN_DOCKER=true
